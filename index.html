<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scheduled- Login</title>
  <link rel="stylesheet" href="stylessss.css">
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<!-- Firebase Auth -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<!-- Firestore -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

</head>
<body>
  <div class="login-container">
    <h2>SchedulED</h2>
    <p>Teacher-Student Appointment System</p>

    <!-- Role Switch Buttons -->
    <div class="role-switch">
      <button id="studentBtn" class="active" onclick="setRole('student')">Student</button>
      <button id="teacherBtn" onclick="setRole('teacher')">Teacher</button>
    </div>

    <!-- Input Fields -->
    <input type="email" id="email" class="input-box" placeholder="Enter Email" required>
    <input type="password" id="password" class="input-box" placeholder="Enter Password" required>

    <!-- Login Button -->
    <button class="login-btn" id="loginBtn" onclick="login()">Login as Student</button>

    <!-- Dynamic Register Link -->
    <p class="register-link">Don't have an account? <a href="#" id="registerLink">Register</a></p>
  </div>

  <script>
    let currentRole = 'student';

    // Predefined teacher credentials
    if(!localStorage.getItem('teachers')) {
      const defaultTeachers = [
        { email: "teacher1@example.com", password: "123456", name: "Teacher One" },
        { email: "teacher2@example.com", password: "abcdef", name: "Teacher Two" }
      ];
      localStorage.setItem('teachers', JSON.stringify(defaultTeachers));
    }

    const registerLink = document.getElementById('registerLink');
    registerLink.addEventListener('click', function(event) {
      event.preventDefault();
      if(currentRole === 'student') {
        window.location.href = 'S-register.html';
      } else {
        window.location.href = 'T-register.html';
      }
    });

    function setRole(role) {
      currentRole = role;
      document.getElementById('studentBtn').classList.remove('active');
      document.getElementById('teacherBtn').classList.remove('active');

      if(role === 'student') {
        document.getElementById('studentBtn').classList.add('active');
        document.getElementById('loginBtn').innerText = 'Login as Student';
      } else {
        document.getElementById('teacherBtn').classList.add('active');
        document.getElementById('loginBtn').innerText = 'Login as Teacher';
      }
    }

    function login() {
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value.trim();

  if(!email || !password){
    alert("Please enter all required fields.");
    return;
  }

  let user = null;

  if(currentRole === 'student') {
    const students = JSON.parse(localStorage.getItem('students')) || [];
    user = students.find(s => s.email === email && s.password === password);
    if(!user){
      alert('Invalid student email or password.');
      return;
    }
    localStorage.setItem('loggedInStudent', JSON.stringify(user));
    window.location.href = 'dashboard.html';
  } else {
    const teachers = JSON.parse(localStorage.getItem('teachers')) || [];
    user = teachers.find(t => t.email === email && t.password === password);
    if(!user){
      alert('Invalid teacher email or password.');
      return;
    }
    localStorage.setItem('loggedInTeacher', JSON.stringify(user));
    window.location.href = 'T-dashboard.html';
  }

  // Save/update in Firebase Firestore
  if(user){
    db.collection('users').doc(user.email).set({
      name: user.name,
      email: user.email,
      role: currentRole
    }, { merge: true }) // merge ensures we donâ€™t overwrite existing data
    .then(() => console.log(`${user.email} synced to Firebase`))
    .catch(err => console.error("Firebase sync error:", err));
  }
}



    
  </script>
</body>
</html>

